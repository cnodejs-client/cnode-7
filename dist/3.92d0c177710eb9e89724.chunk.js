webpackJsonp([3],{"+WNm":function(e,t,n){t=e.exports=n("lcwS")(void 0),t.push([e.i,".spinner{margin:10px auto;width:25px;height:25px;left:50%;position:fixed;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.container1>div,.container2>div,.container3>div{width:6px;height:6px;background-color:#108ee9;border-radius:50%;position:fixed;-webkit-animation:bouncedelay 1.2s infinite ease-in-out;animation:bouncedelay 1.2s infinite ease-in-out;-webkit-animation-fill-mode:both;animation-fill-mode:both}.spinner .spinner-container{position:fixed;width:100%;height:100%}.container2{-webkit-transform:rotate(45deg);transform:rotate(45deg)}.container3{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.circle1{top:0;left:0}.circle2{top:0;right:0}.circle3{right:0;bottom:0}.circle4{left:0;bottom:0}.container2 .circle1{-webkit-animation-delay:-1.1s;animation-delay:-1.1s}.container3 .circle1{-webkit-animation-delay:-1s;animation-delay:-1s}.container1 .circle2{-webkit-animation-delay:-.9s;animation-delay:-.9s}.container2 .circle2{-webkit-animation-delay:-.8s;animation-delay:-.8s}.container3 .circle2{-webkit-animation-delay:-.7s;animation-delay:-.7s}.container1 .circle3{-webkit-animation-delay:-.6s;animation-delay:-.6s}.container2 .circle3{-webkit-animation-delay:-.5s;animation-delay:-.5s}.container3 .circle3{-webkit-animation-delay:-.4s;animation-delay:-.4s}.container1 .circle4{-webkit-animation-delay:-.3s;animation-delay:-.3s}.container2 .circle4{-webkit-animation-delay:-.2s;animation-delay:-.2s}.container3 .circle4{-webkit-animation-delay:-.1s;animation-delay:-.1s}@-webkit-keyframes bouncedelay{0%,80%,to{-webkit-transform:scale(0)}40%{-webkit-transform:scale(1)}}@keyframes bouncedelay{0%,80%,to{transform:scale(0);-webkit-transform:scale(0)}40%{transform:scale(1);-webkit-transform:scale(1)}}",""])},"2hr2":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Spin=void 0;var a=n("1n8/"),o=function(e){return e&&e.__esModule?e:{default:e}}(a);n("jJrt");var r=function(e){var t={};return t=e.hasOwnProperty("style")?e.style:{top:"45px"},o.default.createElement("div",{className:!0===e.loading?"spinner":"",style:t},o.default.createElement("div",{className:!0===e.loading?"spinner-container container1":""},o.default.createElement("div",{className:"circle1"}),o.default.createElement("div",{className:"circle2"}),o.default.createElement("div",{className:"circle3"}),o.default.createElement("div",{className:"circle4"})),o.default.createElement("div",{className:!0===e.loading?"spinner-container container2":""},o.default.createElement("div",{className:"circle1"}),o.default.createElement("div",{className:"circle2"}),o.default.createElement("div",{className:"circle3"}),o.default.createElement("div",{className:"circle4"})),o.default.createElement("div",{className:!0===e.loading?"spinner-container container3":""},o.default.createElement("div",{className:"circle1"}),o.default.createElement("div",{className:"circle2"}),o.default.createElement("div",{className:"circle3"}),o.default.createElement("div",{className:"circle4"})))};r.Defaultprops={loading:!0},t.Spin=r},aHVj:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n("1n8/"),s=a(c),u=n("obMO"),d=n("jYI/"),m=n("1cmS"),f=n("AWhJ"),p=n("2hr2"),h=n("rw4d"),y=n("cZ/O"),g=a(y),v=n("6orE"),E=m.Input.TextArea,b=null,k=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.reload=function(){(0,h.loadMore)()&&n.setState({floor:n.state.floor+10})},n.update=function(){var e=n.props.match.params.id;(0,g.default)("/topic/"+e).then(function(e){n.setState({data:e.data})}).catch(function(e){console.log("error")})},n.handleText=function(e){n.setState({text:e.target.value})},n.send=function(){var e=n.state.text,t=n.props.match.params.id,a=n.props.accesstoken;""!==e.trim()?(0,g.default)("/topic/"+t+"/replies",{accesstoken:a,content:e}).then(function(e){void 0!==e.success&&!0===e.success&&(n.setState({text:""}),m.message.info("发送成功"),n.update())}):m.message.error("总要写点什么吧")},n.state={data:{replies:[],author:{}},floor:10,text:""},b=n.props.history,n}return i(t,e),l(t,[{key:"componentDidMount",value:function(){document.body.scrollTop=0,this.update(),window.addEventListener("scroll",this.reload)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.reload)}},{key:"render",value:function(){var e=this.state.data,t=this.props,n=t.accesstoken,a=t.UserID;return s.default.createElement("div",null,s.default.createElement(f.Guide,{history:this.props.history,title:e.title}),void 0===e.content?s.default.createElement(p.Spin,{loading:void 0===e.content}):s.default.createElement("div",null,s.default.createElement(w,{data:e}),s.default.createElement("h2",{className:"topic-title"},e.title),s.default.createElement("div",{dangerouslySetInnerHTML:{__html:""+e.content.replace("markdown-text","topic-text")}}),s.default.createElement("div",{className:"topic-reply-count"},"共",s.default.createElement("span",{style:{color:"#108ee9"}},e.reply_count),"条回复"),s.default.createElement(_,{replies:e.replies,floor:this.state.floor,accesstoken:n,id:e.id,myname:a.loginname,authorname:e.author.loginname,update:this.update}),""===n?s.default.createElement(f.Tip,{style:{padding:"20px 0"}}):s.default.createElement("div",null,s.default.createElement(E,{id:"reply-textArea",placeholder:"支持markdown语法",onChange:this.handleText,value:this.state.text}),s.default.createElement(m.Button,{id:"reply-btn",onClick:this.send},"回复")),s.default.createElement("div",{style:{height:"35px"}})))}}]),t}(c.Component),w=function(e){var t=e.data;return s.default.createElement("div",{className:"topic-content"},s.default.createElement(u.Link,{to:"/user/"+t.author.loginname},s.default.createElement("img",{src:t.author.avatar_url,className:"avator",alt:t.author.loginname})),s.default.createElement("p",{style:{marginBottom:"13px"}},s.default.createElement("span",{className:"loginname"},t.author.loginname),s.default.createElement("span",{className:"visted-count"},"阅读:",t.visit_count)),s.default.createElement("span",{style:{marginLeft:"5px"}},(0,h.formatTime)(t.create_at)),s.default.createElement("span",{className:"last_reply_at"},(0,h.formatTime)(t.last_reply_at)))},_=function(e){return e.replies.map(function(t,n){return n<e.floor?s.default.createElement("div",{className:"anwser",key:t.author.loginname+n},s.default.createElement(u.Link,{to:"/user/"+t.author.loginname},s.default.createElement("img",{src:t.author.avatar_url,className:"avator",alt:t.author.loginname})),s.default.createElement("span",{className:"loginname"},t.author.loginname," ",t.author.loginname===e.authorname?"楼主":""),s.default.createElement("span",{style:{fontSize:"1.3rem"}},(0,h.formatTime)(t.create_at)),s.default.createElement("span",{style:{fontSize:"1.3rem",float:"right",marginRight:"8px"}},n+1+"楼"),s.default.createElement("div",{dangerouslySetInnerHTML:{__html:""+t.content},key:n}),s.default.createElement("div",{style:{textAlign:"right"}},s.default.createElement(N,{length:t.ups.length,id:t.id,accesstoken:e.accesstoken,authorname:e.authorname,anwsername:t.author.loginname,myname:e.myname}),s.default.createElement(x,{id:e.id,accesstoken:e.accesstoken,reply_id:t.id,loginname:t.author.loginname,update:e.update}))):s.default.createElement("div",{key:n})})},N=function(e){function t(){var e,n,a,i;o(this,t);for(var l=arguments.length,c=Array(l),s=0;s<l;s++)c[s]=arguments[s];return n=a=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),a.state={action:""},a.sendUps=function(){var e=a.props,t=e.id,n=e.accesstoken,o=e.myname,r=e.anwsername;""!==n?r!==o?(0,g.default)("/reply/"+t+"/ups",{accesstoken:n}).then(function(e){a.setState({action:e.action})}):m.message.warning("不能给自己点赞哦"):(m.message.info("您还没有登陆"),(0,v.setTimeout)(function(){b.push("/my/login")},300))},i=n,r(a,i)}return i(t,e),l(t,[{key:"render",value:function(){var e=this.state.action,t=this.props.length,n={color:"up"===e?"#108ee9":"rgba(0,0,0,0.65)",fontWeight:"up"===e?"600":"400"};return s.default.createElement("span",null,s.default.createElement("i",{className:"iconfont icon-dianzan",style:n,onClick:this.sendUps},s.default.createElement("span",{className:"icon-dianzan-num"},"up"===e?t+1:t)))}}]),t}(c.Component),x=function(e){function t(){var e,n,a,i;o(this,t);for(var l=arguments.length,c=Array(l),s=0;s<l;s++)c[s]=arguments[s];return n=a=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),a.state={status:!1,content:""},a.handleReply=function(){a.setState({status:!a.state.status})},a.handleValue=function(e){a.setState({content:e.target.value})},a.send=function(){var e=a.state.content,t=a.props,n=t.id,o=t.accesstoken,r=t.reply_id;console.log(r),""!==o?""!==e.trim()?(0,g.default)("/topic/"+n+"/replies",{accesstoken:o,content:e,reply_id:r}).then(function(e){void 0!==e.success&&!0===e.success&&a.setState({status:!1}),m.message.success("发送成功"),a.props.update()}):m.message.warning("总要写点什么吧"):m.message.info("您还没有登陆")},i=n,r(a,i)}return i(t,e),l(t,[{key:"render",value:function(){var e=this.state.status,t=this.props.loginname;return s.default.createElement("span",null,s.default.createElement("i",{className:"iconfont icon-huifu",onClick:this.handleReply}),e?s.default.createElement("p",null,s.default.createElement(E,{style:{height:"60px"},onChange:this.handleValue,defaultValue:"@"+t+" ",minLength:("@"+t).length}),s.default.createElement(m.Button,{style:{float:"left"},onClick:this.send},"回复")):null)}}]),t}(c.Component),S=function(e){return{accesstoken:e.SetAccessToken.AccessToken,UserID:e.SetUserID.UserID}};t.default=(0,d.connect)(S)(k)},"cZ/O":function(e,t,n){"use strict";function a(e){if(e.status<200||e.status>300)throw new Error("出错了");return e.json()}function o(e,t){return void 0===t?fetch("https://cnodejs.org/api/v1"+e).then(function(e){return a(e)}).catch(function(e){r.message.error("请求失败")}):fetch("https://cnodejs.org/api/v1"+e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return a(e)}).catch(function(e){r.message.error("请求失败")})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n("1cmS")},jJrt:function(e,t,n){var a=n("+WNm");"string"==typeof a&&(a=[[e.i,a,""]]);var o={};o.transform=void 0;n("BMrJ")(a,o);a.locals&&(e.exports=a.locals)},rw4d:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){var e=0,t=0;return document.body&&(e=document.body.scrollTop),document.documentElement&&(t=document.documentElement.scrollTop),e-t>0?e:t},o=function(){var e=0,t=0;return document.body&&(e=document.body.scrollHeight),document.documentElement&&(t=document.documentElement.scrollHeight),e-t>0?e:t},r=function(){return"CSS1Compat"===document.compatMode?document.documentElement.clientHeight:document.body.clientHeight},i=function(){return Math.abs(a()+r()-o())<1},l=function(e){var t=new Date(e),n=(new Date).getTime()-t.getTime();return n<0?"":n/1e3<60?"刚刚":n/6e4<60?parseInt(n/6e4,10)+"分钟前":n/36e5<24?parseInt(n/36e5,10)+"小时前":n/864e5<31?parseInt(n/864e5,10)+"天前":n/2592e6<12?parseInt(n/2592e6,10)+"月前":parseInt(n/31536e6,10)+"年前"};t.loadMore=i,t.ScrollTop=a,t.WindowHeight=r,t.ScrollHeight=o,t.formatTime=l}});
//# sourceMappingURL=3.92d0c177710eb9e89724.chunk.js.map